<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personagem</title>
    <link rel="stylesheet" href="css/personagem.css">
    <link rel="stylesheet" href="css/global.css">
</head>

<body onload="validarCadastro()">
   <header class="header_landing_page">
        <div class="container">
            <div class="cont_links">
                <a href="index.html#banner" class="link ativo">
                    Home
                </a>
                <a href="index.html#universo_carros" class="link">
                    Universo
                </a>
                <a href="index.html#filmes" class="link">
                    Filmes
                </a>
                <a href="index.html#personagens" class="link">
                    Personagens
                </a>
                <a href="escolhaCorredor.html" class="link fontPixel">
                    Copa Pistão
                </a>
            </div>
            <div class="cont_logo">
                <img class="logo" src="https://i.postimg.cc/zDjshTg0/logo-carros.png" alt="">
            </div>
            <div id="container_autenticar" class="cont_btns_autenticar">

            </div>
        </div>
    </header>
    <div class="container" id="container_personagem">

    </div>
</body>

</html>
<script>

    function validarCadastro() {
        console.log(sessionStorage.EMAIL_USUARIO);
        console.log(sessionStorage.NOME_USUARIO);
        console.log(sessionStorage.ID_USUARIO);

        if (sessionStorage.EMAIL_USUARIO != undefined && sessionStorage.NOME_USUARIO != undefined && sessionStorage.ID_USUARIO != undefined) {
            container_autenticar.innerHTML = `<a onclick="sair()" class="link">Sair</a>`
        }
        if (sessionStorage.EMAIL_USUARIO == undefined && sessionStorage.NOME_USUARIO == undefined && sessionStorage.ID_USUARIO == undefined) {
            container_autenticar.innerHTML = `
                <a href="cadastro.html" class="link">
                    Cadastro
                </a>
                <hr>
                <a href="login.html" class="link">
                    Login
                </a>
            `
        }

    }
    function sair() {
        sessionStorage.clear();
        mudarBtns()
    }
    function mudarBtns() {
        container_autenticar.innerHTML = `
            <a href="cadastro.html" class="link">
                Cadastro
            </a>
            <hr>
            <a href="login.html" class="link">
                Login
            </a>
        `

    }
    var urlParametros = window.location
    var idParametro = urlParametros.search.replace('?id=', '')
    var container_personagem = document.getElementById('container_personagem')
    console.log(urlParametros);
    console.log(`ID do personagem: ${idParametro}`);
    fetch('/personagens/buscar', {
        method: "POST",
        headers: {
            "Content-Type": "application/json"
        },
        body: JSON.stringify({
            idServer: idParametro,
        })
    })
        .then(response => response.json())
        .then(personagens => {
            var personagem = []
            for (var i = 0; i < personagens.length; i++) {
                var personagemAtual = personagens[i];
                if (personagemAtual.id == idParametro) {
                    personagem = personagemAtual
                    console.log(personagemAtual);
                }
            }

            if (personagem != undefined) {
                var nascimento = new Date(personagem.nascimento)
                var dataNascimento = nascimento.toLocaleDateString('pt-BR');
                container_personagem.innerHTML = `
                        <div class="container_imagem">
                            <img src="${personagem.imagem_personagem}" alt="">
                        </div>
                        <div class="container_textos">
                            <div class="container">
                                <h1 class="subtitulo textoPersonagem fontBlack bolder">${personagem.nome}</h1>
                                
                                <h3 class="descricao textoPersonagem fontBlack bolder">Descrição:</h3>
                                <p class="textoSmall textoPersonagem fontBlack ">${personagem.descricao}</p>
                                
                                <h3 class="descricao textoPersonagem fontBlack bolder">Data de nascimento:</h3>
                                <p class="textoSmall textoPersonagem fontBlack ">${dataNascimento}</p>
                                
                                <h3 class="descricao textoPersonagem fontBlack bolder">Modelo:</h3>
                                <p class="textoSmall textoPersonagem fontBlack ">${personagem.modelo}</p>
                                
                                <h3 class="descricao textoPersonagem fontBlack bolder">Equipe:</h3>
                                <p class="textoSmall textoPersonagem fontBlack ">${personagem.equipe}</p>
                                
                                <h3 class="descricao textoPersonagem fontBlack bolder">Primeira aparição:</h3>
                                <p class="textoSmall textoPersonagem fontBlack ">${personagem.aparicao}</p>
                            </div>
                        </div>
                        
                    `


            }

        })

</script>